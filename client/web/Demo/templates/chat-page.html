<!-- èŠå¤©é¡µé¢æ¨¡æ¿ -->
<div class="app-container active" id="chatPage">
    <header class="app-header">
        <h1>MuseumAgent å®¢æˆ·ç«¯</h1>
        <p class="subtitle">åšç‰©é¦†æ™ºèƒ½ä½“Webå®¢æˆ·ç«¯ <button id="logoutBtn" class="btn" style="display: inline-block; width: auto; padding: 4px 12px; font-size: 12px; margin-left: 10px;">ç™»å‡º</button></p>
    </header>

    <div class="main-container">
        <div class="config-panel client-config">
            <h2>1. å®¢æˆ·ç«¯é…ç½®</h2>
            <div class="config-content">
                <div class="form-group">
                    <label for="clientType">å®¢æˆ·ç«¯ç±»å‹:</label>
                    <input type="text" id="clientType" placeholder="è¾“å…¥å®¢æˆ·ç«¯ç±»å‹" value="web">
                </div>
                <div class="form-group">
                    <label for="sceneType">åœºæ™¯ç±»å‹:</label>
                    <input type="text" id="sceneType" placeholder="è¾“å…¥åœºæ™¯ç±»å‹" value="public">
                </div>
                <div class="form-group">
                    <label for="spiritId">ç²¾çµID:</label>
                    <input type="text" id="spiritId" placeholder="è¾“å…¥ç²¾çµID">
                </div>
                <div class="form-group">
                    <label for="enableTTS">å¯ç”¨è¯­éŸ³æ’­æŠ¥:</label>
                    <input type="checkbox" id="enableTTS" checked>
                </div>
                <div class="form-group">
                    <label for="autoPlayVoice">è‡ªåŠ¨æ’­æ”¾è¯­éŸ³æ¶ˆæ¯:</label>
                    <input type="checkbox" id="autoPlayVoice" checked>
                </div>
                <div class="form-group">
                    <label for="sessionId">ä¼šè¯ID:</label>
                    <input type="text" id="sessionId" placeholder="ä¼šè¯ID" readonly>
                </div>
                <div class="form-group">
                    <label for="sessionStatus">ä¼šè¯çŠ¶æ€:</label>
                    <span id="sessionStatus" class="status-badge status-offline">æœªè¿æ¥</span>
                </div>
                <div class="form-group">
                    <button id="querySessionBtn" class="btn btn-primary">æŸ¥è¯¢ä¼šè¯ä¿¡æ¯</button>
                </div>
                
                <!-- VAD é…ç½® -->
                <div class="form-group-section">
                    <h3 style="margin-top: 20px; margin-bottom: 10px; color: #333;">VAD è¯­éŸ³æ£€æµ‹é…ç½®</h3>
                    <div class="form-group">
                        <label for="vadEnabled">
                            <input type="checkbox" id="vadEnabled" checked>
                            å¯ç”¨ VADï¼ˆè¯­éŸ³æ´»åŠ¨æ£€æµ‹ï¼‰
                        </label>
                        <small style="display: block; color: #666; margin-top: 4px;">
                            ä»…åœ¨æ£€æµ‹åˆ°è¯­éŸ³æ—¶é‡‡é›†ï¼ŒèŠ‚çœæµé‡å’Œæ€§èƒ½
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="vadSilenceDuration">é™éŸ³è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰:</label>
                        <input type="number" id="vadSilenceDuration" value="1000" min="500" max="5000" step="100">
                        <small style="display: block; color: #666;">é™éŸ³å¤šä¹…ååœæ­¢é‡‡é›†ï¼ˆæ¨è: 1000msï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label for="vadPositiveThreshold">è¯­éŸ³æ£€æµ‹é˜ˆå€¼:</label>
                        <input type="number" id="vadPositiveThreshold" value="0.5" min="0" max="1" step="0.05">
                        <small style="display: block; color: #666;">0-1ï¼Œè¶Šé«˜è¶Šä¸¥æ ¼ï¼ˆæ¨è: 0.5ï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label for="vadNegativeThreshold">é™éŸ³æ£€æµ‹é˜ˆå€¼:</label>
                        <input type="number" id="vadNegativeThreshold" value="0.35" min="0" max="1" step="0.05">
                        <small style="display: block; color: #666;">0-1ï¼Œè¶Šä½è¶Šä¸¥æ ¼ï¼ˆæ¨è: 0.35ï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label for="vadPreSpeechPad">è¯­éŸ³å‰ä¿ç•™å¸§æ•°:</label>
                        <input type="number" id="vadPreSpeechPad" value="1" min="0" max="10" step="1">
                        <small style="display: block; color: #666;">é¿å…è¯­éŸ³å¼€å¤´è¢«æˆªæ–­ï¼ˆæ¨è: 1ï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label for="vadRedemptionFrames">å®¹é”™å¸§æ•°:</label>
                        <input type="number" id="vadRedemptionFrames" value="8" min="0" max="20" step="1">
                        <small style="display: block; color: #666;">é¿å…çŸ­æš‚é™éŸ³è¯¯åˆ¤ï¼ˆæ¨è: 8ï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label for="vadMinSpeechFrames">æœ€å°è¯­éŸ³å¸§æ•°:</label>
                        <input type="number" id="vadMinSpeechFrames" value="3" min="1" max="10" step="1">
                        <small style="display: block; color: #666;">é¿å…è¯¯è§¦å‘ï¼ˆæ¨è: 3ï¼‰</small>
                    </div>
                    <div class="form-group">
                        <label>VAD çŠ¶æ€:</label>
                        <span id="vadStatus" class="vad-status vad-inactive">ğŸ”‡ æœªå¯åŠ¨</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="resize-handle" id="resizeHandle1"></div>

        <div class="config-panel functions-config">
            <h2>2. å‡½æ•°å®šä¹‰</h2>
            <div class="config-content">
                <div class="form-group full-width">
                    <label for="functions">å®¢æˆ·ç«¯æ”¯æŒçš„å‡½æ•°å®šä¹‰ (JSONæ ¼å¼):</label>
                    <textarea id="functions" class="functions-input" placeholder='
                    [
                        {
                            "name": "FunctionsName",// å‡½æ•°åç§°
                            "description": "FunctionDescription",// å‡½æ•°æè¿°
                            "parameters": // å‚æ•°å®šä¹‰
                            {
                                "type": "object",// å‚æ•°ç±»å‹ä¸ºå¯¹è±¡
                                "properties": // å‚æ•°å±æ€§å®šä¹‰
                                {
                                    "property_name": // å±æ€§åç§°
                                    {
                                        "type": "string",// å±æ€§ç±»å‹ä¸ºå­—ç¬¦ä¸²
                                        "description": "property_description" // å±æ€§æè¿°
                                    }
                                },
                                "required": // å¿…é¡»å‚æ•°
                                [
                                    "property_name"// å¿…é¡»å‚æ•°property_name
                                ]
                            }
                        }
                    ]'>
                    [
                        {
                            "name": "play_emotion",
                            "description": "æ’­æ”¾ç”µå­å® ç‰©çš„è¡¨æƒ…",
                            "parameters": {
                            "type": "object",
                            "properties": {
                                "emotion_name": {
                                "type": "string",
                                "description": "è¡¨æƒ…åç§°ï¼Œå¦‚ï¼šhappyã€sadã€angryã€surprisedã€excitedç­‰"
                                }
                            },
                            "required": ["emotion_name"]
                            }
                        },
                        {
                            "name": "move_to",
                            "description": "ç§»åŠ¨ç”µå­å® ç‰©åˆ°æŒ‡å®šä½ç½®",
                            "parameters": {
                            "type": "object",
                            "properties": {
                                "x": {
                                "type": "number",
                                "description": "Xåæ ‡"
                                },
                                "y": {
                                "type": "number",
                                "description": "Yåæ ‡"
                                },
                                "z": {
                                "type": "number",
                                "description": "Zåæ ‡"
                                }
                            },
                            "required": ["x", "y", "z"]
                            }
                        },
                        {
                            "name": "play_animation",
                            "description": "æ’­æ”¾ç”µå­å® ç‰©çš„åŠ¨ç”»",
                            "parameters": {
                            "type": "object",
                            "properties": {
                                "animation_name": {
                                "type": "string",
                                "description": "åŠ¨ç”»åç§°ï¼Œå¦‚ï¼šwalkã€runã€jumpã€danceã€waveç­‰"
                                }
                            },
                            "required": ["animation_name"]
                            }
                        },
                        {
                            "name": "sleep",
                            "description": "è®©ç”µå­å® ç‰©è¿›å…¥ç¡çœ çŠ¶æ€",
                            "parameters": {
                            "type": "object",
                            "properties": {},
                            "required": []
                            }
                        },
                        {
                            "name": "wake_up",
                            "description": "å”¤é†’ç”µå­å® ç‰©",
                            "parameters": {
                            "type": "object",
                            "properties": {},
                            "required": []
                            }
                        }
                    ]</textarea>
                </div>
            </div>
        </div>

        <div class="resize-handle" id="resizeHandle2"></div>

        <div class="chat-panel">
            <h2>3. èŠå¤©çª—</h2>
            <div class="chat-container">
                <div class="message-history" id="messageHistory">
                    <!-- æ¶ˆæ¯å†å²è®°å½• -->
                </div>
                <div class="message-input">

                    <div class="input-area">
                        <textarea id="chatInput" placeholder="è¾“å…¥æ¶ˆæ¯..."></textarea>
                    </div>
                    <div class="input-controls">
                        <button id="sendMessageBtn" class="btn btn-primary">å‘é€</button>
                        <div class="voice-actions">

                            <button id="recordToggleBtn" class="btn btn-primary">å¼€å§‹è¯­éŸ³</button>
                            <span id="recordTime" class="record-time">00:00</span>
                        </div>
                    </div>
                    <div class="voice-recorder" id="voiceRecorder" style="display: none;">
                        <!-- ä¿ç•™åŸå§‹è¯­éŸ³å½•éŸ³å™¨ç»“æ„ï¼Œç¡®ä¿ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ -->
                    </div>
                </div>
            </div>
            

        </div>
    </div>

    <div class="resize-handle resize-handle-vertical" id="resizeHandle3"></div>

    <div class="log-panel">
        <div class="log-header">
            <h2>æ§åˆ¶å°</h2>
            <button id="clearLogBtn" class="btn btn-small btn-secondary">æ¸…ç©º</button>
        </div>
        <div id="logContent" class="log-content"></div>
    </div>
</div>