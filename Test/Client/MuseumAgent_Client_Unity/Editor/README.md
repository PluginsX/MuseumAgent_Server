# 智能体聊天室编辑器工具

适用于 Unity 2022.3 的独立编辑器工具，实现智能体客户端聊天室功能。

## 功能特性

- 独立的编辑器窗口，不依赖运行时组件
- 参考主流AI IDE的对话窗口布局
- 支持多会话管理
- 实时对话消息显示
- 自动心跳机制
- 配置管理功能
- 会话持久化存储

## 文件说明

### Editor/AgentChatWindow.cs
主聊天室窗口脚本，实现完整的对话功能。

### Editor/AgentConfigWindow.cs
配置管理窗口脚本，提供配置界面。

## 安装步骤

1. 将以下文件复制到 Unity 项目的 `Assets/Editor/` 目录：
   - `Editor/AgentChatWindow.cs`
   - `Editor/AgentConfigWindow.cs`

2. 在 Unity 编辑器中等待脚本编译完成

## 使用方法

### 打开聊天室

1. 在 Unity 编辑器中，点击菜单：`Tools > MuseumAgent > 聊天室`
2. 聊天室窗口将自动打开

### 界面布局

聊天室窗口分为两个主要区域：

#### 左侧边栏
- **会话管理**：显示所有会话列表
- **新建会话**：创建新的对话会话
- **配置设置**：打开配置窗口
- **清空所有会话**：删除所有会话
- **连接状态**：显示当前连接状态

#### 右侧主内容区
- **对话消息显示区域**：显示当前会话的所有消息
- **输入框**：输入用户消息
- **发送按钮**：发送消息到服务器

### 消息类型

聊天室支持三种消息类型：

1. **用户消息**（蓝色背景）
   - 用户发送的消息
   - 显示用户图标

2. **助手消息**（灰色背景）
   - 智能体返回的消息
   - 显示助手图标

3. **系统消息**（橙色背景）
   - 系统通知消息
   - 显示系统图标

### 会话管理

#### 创建新会话
1. 点击左侧边栏的"新建会话"按钮
2. 新会话将自动创建并选中
3. 可以开始发送消息

#### 切换会话
1. 在左侧边栏的会话列表中点击会话
2. 对话区域将显示该会话的消息

#### 删除会话
1. 点击"清空所有会话"按钮
2. 确认删除操作
3. 所有会话将被删除

### 配置管理

#### 打开配置窗口
1. 点击左侧边栏的"配置设置"按钮
2. 配置窗口将打开

#### 配置选项

**服务器API配置**
- 服务器基础URL：服务器的基础URL地址
- 会话注册端点：会话注册的API端点
- 会话心跳端点：会话心跳的API端点
- 会话注销端点：会话注销的API端点
- 智能体解析端点：智能体解析的API端点

**客户端基本信息**
- 客户端类型：客户端的类型标识
- 客户端ID：客户端的唯一标识符
- 平台：客户端运行的平台
- 客户端版本：客户端的版本号

**心跳配置**
- 心跳间隔（秒）：发送心跳请求的间隔时间
- 自动启动心跳：是否在启动时自动开始发送心跳

**调试配置**
- 启用调试日志：是否输出详细的调试日志

#### 保存配置
1. 修改配置后，点击"保存"按钮
2. 配置将保存到本地文件
3. 配置窗口将关闭

#### 恢复默认配置
1. 点击"恢复默认配置"按钮
2. 确认恢复操作
3. 配置将恢复为默认值

### 发送消息

1. 在输入框中输入消息
2. 点击"发送"按钮或按回车键
3. 消息将发送到服务器
4. 智能体的响应将显示在对话区域

### 连接状态

聊天室窗口显示以下连接状态：

- **未连接**（灰色）：未与服务器建立连接
- **正在注册...**（黄色）：正在注册会话
- **已连接**（绿色）：会话已激活
- **连接失败**（红色）：连接失败或会话过期

## 数据持久化

### 配置文件
配置保存在：`Application.persistentDataPath/AgentChatConfig.json`

### 会话文件
会话保存在：`Application.persistentDataPath/AgentChatSessions.json`

### 自动保存
- 配置修改后自动保存
- 会话消息自动保存
- 窗口关闭时保存所有数据

## 键盘快捷键

- `Enter`：发送消息
- `Ctrl + Enter`：换行

## 注意事项

1. **网络连接**：确保服务器正在运行且网络连接正常
2. **配置正确**：检查服务器地址和端点配置是否正确
3. **会话管理**：建议定期清理不需要的会话
4. **调试模式**：开发时启用调试日志，生产环境关闭

## 故障排除

### 无法连接服务器
- 检查服务器地址是否正确
- 确认服务器是否正在运行
- 检查网络连接
- 查看调试日志

### 消息发送失败
- 检查会话是否仍然有效
- 确认服务器正常运行
- 检查网络连接
- 查看调试日志

### 会话过期
- 会话会自动重新注册
- 如果重新注册失败，检查配置
- 查看服务器日志

### 配置丢失
- 检查文件系统权限
- 确认Application.persistentDataPath可访问
- 查看调试日志

## 技术特点

### 独立性
- 不依赖运行时组件
- 纯编辑器工具
- 可独立使用

### 布局设计
- 参考主流AI IDE设计
- 左侧边栏 + 右侧主内容
- 响应式布局

### 功能完整
- 完整的API访问
- 会话管理
- 配置管理
- 数据持久化

### 用户体验
- 友好的界面设计
- 清晰的状态显示
- 流畅的交互体验

## 版本要求

- Unity 2022.3 或更高版本
- .NET Standard 2.0 或更高版本

## 许可证

根据项目许可证使用。

## 支持

如有问题，请联系项目维护者。
